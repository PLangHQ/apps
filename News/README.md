# News app

This is simple window app for proof of concept. It displays tech news from newsapi.org and stores it localy.

## How to run
Download the content of this repository to your computer. Open terminal/cmd, navigator to the directory and run the command

```bash
plangw
```

## Summary
This application is designed to provide a continuously updated feed of news articles from specified sources. It initializes by displaying existing news articles from the database and then enters a cycle of fetching the latest news articles every minute. New articles are inserted into the database and the news feed in the application is refreshed to include these latest articles, ensuring that the user always has access to the most recent news.

## Flow explained

The following text explains [Start.goal](Start.goal)


### Start
1. **Initialize the Application Window**: The application launches by initializing its main window and immediately calls the `!LoadNews` function to load and display existing news articles from the database.
2. **Initial Fetch of Latest News**: The `!GetLatestNews` function is called to fetch the latest news articles from the specified sources. This function is executed as a "run and forget," meaning it runs asynchronously without blocking the main application flow.
3. **Periodic News Update**: The application is set up to automatically call `!GetLatestNews` every 1 minute. This ensures that the news feed is regularly updated with the latest articles without requiring manual refreshes by the user.

### LoadNews
1. **Fetch News from Database**: This function retrieves all news articles stored in the `news` database table, ordered by their ID in descending order, ensuring that the newest articles are fetched first. The results are stored in a variable `%news%`.
2. **Display News Articles**: After fetching the news articles, the function triggers a goal `!ui/ShowNews` to display the articles in the application's user interface. The `goal` keyword suggests a specific task or operation within the application, possibly involving a change in the UI.

### GetLatestNews
1. **Determine Fetch Starting Point**: This function first retrieves the `created` timestamp of the most recent article in the database to use as a starting point for fetching new articles. If there's no recent article, it defaults to fetching articles from the past 5 days.
2. **Fetch Latest News from API**: The function makes a GET request to a news API, requesting articles published after the most recent article's `created` timestamp. The request is made to specific domains and includes an API key for authentication. The fetched data is stored in `%news%`.
3. **Process and Insert New Articles**: For each article in the fetched `%news.articles%`, the `!InsertArticle` function is called to insert the new article into the database.
4. **Refresh News Feed**: If any new articles are fetched and inserted (`%news.articles.Count% > 0`), the `!LoadNews` function is called to refresh the news feed in the application, ensuring that the latest articles are displayed.

### InsertArticle
- **Insert New Article into Database**: This function inserts a new article into the `news` table with details such as the article's title, description, URL, URL to the article's image, and the published timestamp.



----
This documentation was generated by ChapGPT (with 2 small changes)

ChapGPT command:
> Explain the flow in this app. This app is written in plang programming language, a pseudo language. This is for README in git repo. [Content of Start.goal]